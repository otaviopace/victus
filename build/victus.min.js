// victus | (c) 2020 sporeball | MIT license
!function(){var t,e,s,o,r,l,h=Math.PI,n=Object;class a{constructor(t,e,s,o,i){(l=this).x=t,l.y=e,l.w=s,l.h=o,l.xv=l.yv=l.rotation=0,l.anchorX=l.w/2,l.anchorY=l.h/2,l.hidden=0,l.setProps(i)}moveTo(t,e){this.x=t,this.y=e}moveBy(t,e){this.x+=t,this.y+=e}anchor(t,e){this.anchorX=t,this.anchorY=e}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){let e=c(this);return e.setProps(t),e}draw(){(l=this).moveBy(l.xv,l.yv);let t=l.x+l.anchorX,s=l.y+l.anchorY;e.save(),e[c="translate"](t,s),e.rotate(l.rotation*(h/180)),e[c](-t,-s),l.hidden||l._(),e.restore()}}var d={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"};[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>d[t]="Key"+t);var u={x:0,y:0,click:0,held:0};document.onmousemove=t=>{u.x=t.pageX,u.y=t.pageY},document.onmousedown=t=>{1==t.which&&(u.held||(u.click=1),u.held=1)},document.onmouseup=t=>{1==t.which&&(u.held=0)},c=t=>{let e=n.create(t);for(i in t)e[i]=t[i];return e},k=(t=0,i=0,l=s,c=o,h=r)=>{e.fillStyle=h,e.fillRect(t,i,l,c)},x=t=>e,this.victus={setup:i=>{t=document.getElementById(i.id),e=t.getContext`2d`,s=t.width=i.w,o=t.height=i.h,r=i.color||"#fff"},Rect:class extends a{constructor(t,e,s,o,i,r){super(t,e,s,o,r),this.col=i}_(){k(l.x,l.y,l.w,l.h,l.col)}},Ellipse:class extends a{constructor(t,e,s,o,i,r){super(t,e,s,o,r),this.col=i}_(){e.fillStyle=l.col,e.beginPath(),e.ellipse(l.x,l.y,l.w,l.h,0,0,2*h),e.closePath(),e.fill()}},Sprite:class extends a{constructor(t,e,s,o,i,r){super(e,s,o,i,r),this.d=new Image,this.d.src=t}_(){e.drawImage(l.d,l.x,l.y,l.w,l.h)}},Text:class extends a{constructor(t,e,s,o=16,i="#000",r="Arial",c="left"){super(e,s),(l=this).str=t,l.size=o,l.col=i,l.font=r,l.align=c}_(){e.fillStyle=l.col,e.font=l.size+"px "+l.font,e.textAlign=l.align,e.fillText(l.str,l.x,l.y)}},Sound:class{constructor(t,e,s=0){(l=this).vol=e,l.d=new Audio(t),l.d.loop=s}reset(){this.d.load()}play(){(l=this).reset(),l.d.volume=l.vol,l.d.play()}pause(){this.d.pause()}},clear:k,keys:d,mouse:u}}();
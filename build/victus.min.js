// victus | (c) 2020 sporeball | MIT license
!function(){var t,s,e,o,h,r,l=Math.PI,n=Object;class a{constructor(t,s,e,i,o){this.x=t,this.y=s,this.w=e,this.h=i,this.xv=this.yv=this.rotation=0,this.anchorX=this.w/2,this.anchorY=this.h/2,this.hidden=0,this.setProps(o)}moveTo(t,s){this.x=t,this.y=s}moveBy(t,s){this.x+=t,this.y+=s}anchor(t,s){this.anchorX=t,this.anchorY=s}hide(){this.hidden=1}show(){this.hidden=0}setProps(t){Object.assign(this,t)}clone(t){let s=c(this);return s.setProps(t),s}draw(){(r=this).moveBy(r.xv,r.yv);let t=r.x+r.anchorX,e=r.y+r.anchorY;s.save(),s[c="translate"](t,e),s.rotate(r.rotation*(l/180)),s[c](-t,-e),r.hidden||r._(),s.restore()}}var d={Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"};[..."ABCDEFGHIJKLMNOPQRSTUVWXYZ"].map(t=>d[t]="Key"+t);var u={x:0,y:0,click:0,held:0};document.onmousemove=t=>{u.x=t.pageX,u.y=t.pageY},document.onmousedown=t=>{1==t.which&&(u.held||(u.click=1),u.held=1)},document.onmouseup=t=>{1==t.which&&(u.held=0)},c=t=>{let s=n.create(t);for(i in t)s[i]=t[i];return s},k=(t=0,i=0,r=e,l=o,c=h)=>{s.fillStyle=c,s.fillRect(t,i,r,l)},x=t=>s,this.victus={setup:i=>{t=document.getElementById(i.id),s=t.getContext`2d`,e=t.width=i.w,o=t.height=i.h,h=i.color||"#fff"},Rect:class extends a{constructor(t,s,e,i,o,h){super(t,s,e,i,h),this.col=o}_(){k(r.x,r.y,r.w,r.h,r.col)}},Ellipse:class extends a{constructor(t,s,e,i,o,h){super(t,s,e,i,h),this.col=o}_(){s.fillStyle=r.col,s.beginPath(),s.ellipse(r.x,r.y,r.w,r.h,0,0,2*l),s.closePath(),s.fill()}},Sprite:class extends a{constructor(t,s,e,i,o,h){super(s,e,i,o,h),this.d=new Image,this.d.src=t}_(){s.drawImage(r.d,r.x,r.y,r.w,r.h)}},Text:class extends a{constructor(t,s,e,i=16,o="#000",h="Arial",r="left"){super(s,e),this.str=t,this.size=i,this.col=o,this.font=h,this.align=r}_(){s.fillStyle=r.col,s.font=r.size+"px "+r.font,s.textAlign=r.align,s.fillText(r.str,r.x,r.y)}},Sound:class{constructor(t,s,e=0){this.vol=s,this.d=new Audio(t),this.d.loop=e}reset(){this.d.load()}play(){(r=this).reset(),r.d.volume=r.vol,r.d.play()}pause(){this.d.pause()}},clear:k,keys:d,mouse:u}}();